<!DOCTYPE html>
<html>
<head>
	<% include ../partials/header.ejs %>
	<!--Your own css file-->
	<link rel="stylesheet" type="text/css" href="/stylesheets/pages/petShop.css" />
	<link rel="stylesheet" type="text/css" href="/stylesheets/fontawesome-all.css"/>
	<link rel="stylesheet" type="text/css" href="/stylesheets/nouislider.min.css"/>
	<style>
		.noUi-handle {
			background: grey;
			border: none;
			border-radius: 50%;
			height: 5px;
			width: 5px;
		}
		
		.noUi-connect {
			background: #33b5e5;
		}
	</style>
	<title>Pet Supplies Shop</title>
</head>

<body>
<% include ../partials/headline.ejs %>

<section class="main-content">
	<div class="container-fluid">
	<!--Your own content-->
	<div class="shop">
		<div class="row">
			<div class="col-md-3" id="filter_button">
				<a id="show_hide_button">
					<span class="filter_hide_button"><span class="fa fa-caret-left"></span>Hide</span>
					<span class="filter_show_button"><span class="fa fa-caret-right"></span>Show</span>
					Filter
				</a>
			</div>
			<div class="col-md-4" id="items_count">
				<!--SERVER-->
				<div><span class="item_number" id="first_item_number">1</span>&nbsp;-&nbsp;<span class="item_number" id="last_item_number">60</span>&nbsp;of&nbsp;<span class="item_number" id="total_item_number">500</span>&nbsp;items</div>
			</div>
			<div class="col-md-2" id="display_size">
				<div>View:&nbsp;<a class="fa fa-th-large" id="less_icon"></a><a class="fa fa-th" id="more_icon"></a></div>
			</div>
			<div class="col-md-3" id="sort_dropdown">
				<select id="dropdownlist">
					<option value="popular" selected="selected">&#xf06d; Popular</option>
					<option value="newest">&#xf017; Newest</option>
					<option value="price" data-order="asc">&#xf160; Price - Low to High</option>
					<option value="price" data-order="desc">&#xf161; Price - High to Low</option>
				</select>
			</div>
		</div>
		<br>
		<div class="row">
			<div class="col-md-2" id="left_container">
				<div class="search-container">
					<form id="searchBar">
						<input type="text" id="search" placeholder="Search.." name="search"/><button class="search_button" type="submit">&#xf002;</button>
					</form>
				</div>
				<br>
				<br>
				<div class="filtering">
					<form id="filter_form">
						<div class="condition">
							<button type="button" class="btn btn-light btn-block collapsed" data-toggle="collapse" data-target="div.condition #collapse_condition">CONDITION<i class="fa fa-plus"></i></button>
							<div id="collapse_condition" class="collapse">
								<label class="container">New
									<input type="radio" id="new" name="radio"/>
									<span class="checkmark"></span>
								</label>
								<label class="container">Used
									<input type="radio" id="used" name="radio"/>
									<span class="checkmark"></span>
								</label>
							</div>
						</div>
						<br>
						<div class="price">
							<button type="button" class="btn btn-light btn-block collapsed" data-toggle="collapse" data-target="div.price #collapse_price">PRICE<i class="fa fa-plus"></i></button>
							<div id="collapse_price" class="collapse">
								<br>
								<div id="price_range"></div>
								<br>
								<div id="price_range_text">$<span id="min_price"></span> - $<span id="max_price"></span></div>
							</div>
						</div>
						<br>
						<div class="pet_types">
							<button type="button" class="btn btn-light btn-block collapsed" data-toggle="collapse" data-target="div.pet_types #collapse_pet_types">PET TYPES<i class="fa fa-plus"></i></button>
							<div id="collapse_pet_types" class="collapse">
								<label class="container">Dog
									<input type="checkbox" id="dog"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Cat
									<input type="checkbox" id="cat"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Bird
									<input type="checkbox" id="bird"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Fish
									<input type="checkbox" id="fish"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Reptile
									<input type="checkbox" id="reptile"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Rodent
									<input type="checkbox" id="rodent"/>
									<span class="checkbox"></span>
								</label>
							</div>
						</div>
						<br>
						<div class="category">
							<button type="button" class="btn btn-light btn-block collapsed" data-toggle="collapse" data-target="div.category #collapse_category">CATEGORY<i class="fa fa-plus"></i></button>
							<div id="collapse_category" class="collapse">
								<label class="container">Food
									<input type="checkbox" id="food"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Beds &amp; Cages
									<input type="checkbox" id="beds_cages"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Feeding Utensils
									<input type="checkbox" id="feeding_utensils"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Health Products
									<input type="checkbox" id="health_products"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Collars, Leads &amp; Harness
									<input type="checkbox" id="clhm"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Grooming
									<input type="checkbox" id="grooming"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Fashion
									<input type="checkbox" id="fashion"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Waste Management
									<input type="checkbox" id="waste_management"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Toys
									<input type="checkbox" id="toys"/>
									<span class="checkbox"></span>
								</label>
								<label class="container">Travelling Equipment
									<input type="checkbox" id="travelling_equipment"/>
									<span class="checkbox"></span>
								</label>
							</div>
						</div>
						<br>
						<input class="btn btn-success" type="submit" value="Submit">
						<input class="btn btn-danger" type="reset" value="Reset">
					</form>
				</div>
			</div>
      
					<div class="col-md-10" >
				<div class="row" id="product_display">
						<div class="card-deck">
						<!--
								<div class="card">
									<div class="thumbnail">
										
										<a href="" class="product_page">
											<img class="product_image" src="/images/cat1.jpg"/>
										</a>
										<div class="details">
											
											<a class="user" href="">
												<div class="user-photo">
													<img class="user_image" src="/images/user_image.jpg"/>
												</div>
												<div class="username">User</div>
											</a>
											
											<div class="heart_info">
												<div class="heart_no"><i class="fab fa-gratipay"></i>100</div>
											</div>
										</div>
										<div class="arrow">
											<div class="left_arrow">&#xf104;</div>
											<div class="right_arrow">&#xf105;</div>
										</div>	
									</div>
									<div class="card-info">
										<div class="product_info">
											
											<a href="" class="product_page">
												<p class="product_title">Cat</p>
												<p class="item_price">HKD$500</p>
												<p class="item_description">100% new cat food</p>
											</a>
										</div>
										<div class="product_buttons">
											<div class="shopping_cart">
												<i class="fa fa-cart-plus"></i>
											</div>
											<div class="heart">
												<i class="far fa-heart"></i>
												<i class="fas fa-heart"></i>
											</div>
										</div>
									</div>
								</div>
								<div class="card">
										<div class="thumbnail">
											
											<a href="" class="product_page">
												<img class="product_image" src="/images/cat3.jpg"/>
											</a>
											<div class="details">
												
												<a class="user" href="">
													<div class="user-photo">
														<img class="user_image" src="/images/user_image.jpg"/>
													</div>
													<div class="username">User</div>
												</a>
												
												<div class="heart_info">
													<div class="heart_no"><i class="fab fa-gratipay"></i>100</div>
												</div>
											</div>
											<div class="arrow">
												<div class="left_arrow">&#xf104;</div>
												<div class="right_arrow">&#xf105;</div>
											</div>	
										</div>
										<div class="card-info">
											<div class="product_info">
												
												<a href="" class="product_page">
													<p class="product_title">Cat</p>
													<p class="item_price">HKD$500</p>
													<p class="item_description">100% new cat food</p>
												</a>
											</div>
											<div class="product_buttons">
												<div class="shopping_cart">
													<i class="fa fa-cart-plus"></i>
												</div>
												<div class="heart">
													<i class="far fa-heart"></i>
													<i class="fas fa-heart"></i>
												</div>
											</div>
										</div>
									</div>
								
								<div class="col-md-4 product_card">
									<a class="product_image_link">
										<div class="image_controller">
											<div class="arrow">
												<div class="left_arrow" onclick="plusDiv(1)">&#xf104;</div>
												<div class="right_arrow" onclick="plusDiv(-1)">&#xf105;</div>
											</div>
											<div class="product_grid_item">
												<img class="product_image" src="/images/cat1.jpg"/>
												<img class="product_image" src="/images/cat2.png"/>
												<img class="product_image" src="/images/cat3.jpg"/>
												<img class="product_image" src="/images/dog1.jpg"/>
											</div>
										</div>
									</a>
								</div>
							-->
							</div> 
						</div>
					</div>
				</div>
			</div>
		</section>

<% include ../partials/script.ejs %>

<!--Your own script-->
<script src="/javascript/jquery.js"></script>
<script src="/javascript/nouislider.min.js"></script>
<script>
	var supplyData;

	$(function(){		
		/*
-		var slideIndex = 1;
-		showDiv(slideIndex);
-		
-		function plusDiv(n) {
-			showDiv(slideIndex += n);
-		}
-
-		function showDiv(n) {
-			var images = document.getElementsByClassName("product_image");
-			if(n > images.length) { slideIndex = 1;}
-			if(n < 1) { slideIndex = images.length;}
-			for(var i = 0; i < images.length; i++) {
-				images[i].style.display = "none";
-			}
-			images[slideIndex-1].style.display = "block";
-		}
-		*/
		
		$(".product_image").hover(function() {
			$(event.target).parent().find(".details").animate({opacity: "0.0"});
		}, function(){
			$(event.target).parent().find(".details").animate({opacity: "1.0"});
		})

		supplyData= $.ajax({
					url: "/listSupply",
					type: "GET",
					data: {
						query:"",
					},
					success: function (mes) {
						if (mes.length==0){
							$("#product_display").html("<div style=\"text-align: center;margin: 0 auto;\">No record found</div>");	
						}
						else{
							mes.forEach(function(element,index) {
								$("#product_display").append("\
									<div class=\"col-lg-4 col-md-6 mb-4\">\
											<div class=\"card\">\
												<div class=\"thumbnail\">\
													<a class=\"product_image\">"+element.supplyurl+"</a>\
													<a href=\"\" class=\"product_page\">\
														<div class=\"thumb-cover\"></div>\
													</a>\
													<div class=\"details\">\
														<a class=\"user\" href=\"\">\
															<div class=\"user-photo\">\
																<img class=\"user_image\" src=\"/images/user_image.jpg\"/>\
															</div>\
															<div class=\"username\">User</div>\
														</a>\
														<div class=\"heart_info\">\
															<div class=\"heart_no\"><i class=\"fab fa-gratipay\"></i>" + 100 + "</div>\
														</div>\
													</div>\
													<div class=\"arrow\">\
														<div class=\"left_arrow\">&#xf104;</div>\
														<div class=\"right_arrow\">&#xf105;</div>\
													</div>\
													<div class=\"card-info\">\
														<div class=\"product_info\">\
															<a href=\"\" class=\"product_page\">\
																<h4 class=\"product_title\">" + element.name +"</h4>\
																<p class=\"item_price\">HKD" + element.price + "</p>\
																<p class=\"item_description\">" + element.description +"</p>\
															</a>\
														</div>\
														<div class=\"product_buttons\">\
															<div class=\"shopping_cart\">\
																<i class=\"fa fa-cart-plus\"></i>\
															</div>\
															<div class=\"heart\">\
																<i class=\"far fa-heart\"></i>\
																<i class=\"fas fa-heart\"></i>\
															</div>\
														</div>\
													</div>\
												</div>\
											</div>\
									</div>")
							});
						}
						return mes;
					},
					error: function (err) {
						return err;
					}
				});

		$(".thumbnail").hover(function() {
			$(".arrow").toggle();
 		});

		$("#show_hide_button").click(function(){
			$("#left_container").toggle();
			$(".filter_hide_button").toggle();
			$(".filter_show_button").toggle();
		});
		$("#more_icon").click(function(){
			$("#more_icon").css({
				'opacity': '1.0',
				'pointer-events': 'none',
				'cursor': 'default'
			});
			$("#less_icon").css({
				'opacity': '0.5',
				'pointer-events': 'auto',
				'cursor': 'pointer'
			});
		});
		$("#less_icon").click(function(){
			$("#less_icon").css({
				'opacity': '1.0',
				'pointer-events': 'none',
				'cursor': 'default'
			});
			$("#more_icon").css({
				'opacity': '0.5',
				'pointer-events': 'auto',
				'cursor': 'pointer'
			});
		});
		$("div.filtering button").click(function(){
			$("i", this).toggleClass("fa fa-minus fa fa-plus")
		});

		var nonLinearStepSlider = document.getElementById('price_range');

		noUiSlider.create(nonLinearStepSlider, {
			start: [0, 5000],
			connect: true,
			range: {
				'min': [0, 10],
				'40%': [1000, 100],
				'max': [5000]
			},
			cssPrefix: 'noUi-'
		})
		var nodes = [
			document.getElementById('min_price'), // 0
			document.getElementById('max_price')  // 1
		];
		nonLinearStepSlider.noUiSlider.on('update', function(values, handle){
			nodes[handle].innerHTML = values[handle];
		})
	});


function findSupply(){
	var searchQuery="";
	var temp="";
	if ($("#condition").val()!=null){
		temp="";
		if (document.getElementById("new").checked = true)
			temp+="'new'";
		else
			temp+="'used'";

		temp=temp.substring(0,temp.length-1);
		searchQuery+=" AND status IN("+temp+")";
	}


	if ($("#pet_types").val()!=null){
		temp="";
		if (document.getElementById("dog").checked = true)
			temp+="'dog',";
		if (document.getElementById("cat").checked = true)
			temp+="'cat',";
		if (document.getElementById("bird").checked = true)
			temp+="'bird',";
		if (document.getElementById("fish").checked = true)
			temp+="'fish',";
		if (document.getElementById("reptile").checked = true)
			temp+="'reptile',";
		if (document.getElementById("rodent").checked = true)
			temp+="'rodent',";	

		temp=temp.substring(0,temp.length-1);

		searchQuery+=" AND pettype IN("+temp+")";
	}

	if ($("#category").val()!=null){
		temp="";
		if (document.getElementById("food").checked = true)
			temp+="'food',";
		if (document.getElementById("beds_cages").checked = true)
			temp+="'beds_cages',";	
		if (document.getElementById("feeding_utensils").checked = true)
			temp+="'feeding_utensils',";	
		if (document.getElementById("health_products").checked = true)
			temp+="'health_products',";	
		if (document.getElementById("clhm").checked = true)
			temp+="'clhm',";	
		if (document.getElementById("grooming").checked = true)
			temp+="'grooming',";	
		if (document.getElementById("fashion").checked = true)
			temp+="'fashion',";	
		if (document.getElementById("waste_management").checked = true)
			temp+="'waste_management',";	
		if (document.getElementById("toys").checked = true)
			temp+="'toys',";	
		if (document.getElementById("travelling_equipment").checked = true)
			temp+="'travelling_equipment',";	

		temp=temp.substring(0,temp.length-1);
		searchQuery+=" AND type IN("+temp+")";
	}
}

</script>


</body>
</html>